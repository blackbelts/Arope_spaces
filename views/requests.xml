<odoo>
    <data>
        <record model="ir.ui.view" id="crm__lead_form_view">
            <field name="model">crm.lead</field>
            <field name="inherit_id" ref="crm.crm_lead_view_form"/>
            <field name="arch" type="xml">

                <header>
                    <button string="Send To Insurer" name="send_mail_template_insurer" type="object"/>
                </header>
<!--                <field name="user_id" position="attributes">-->
<!--                    <attribute name="context">{'filter_own_user': True}</attribute>-->
<!--                </field>-->
<!--                <field name="partner_id" position="attributes">-->
<!--                    <attribute name="context">{'own_customer_only':1}</attribute>-->
<!--                </field>-->

                <xpath expr="//field[@name='planned_revenue']/parent::div" position="attributes">
                    <attribute name="invisible">1</attribute>
                </xpath>
                <xpath expr="//field[@name='probability']/parent::div" position="attributes">
                    <attribute name="invisible">1</attribute>
                </xpath>
<!--                <xpath expr="//field[@name='partner_id']/parent::div" position="attributes">-->
<!--                    <attribute name="invisible">1</attribute>>-->
<!--                </xpath>-->
                <xpath expr="//field[@name='partner_id']" position="attributes">
                    <attribute name="invisible">1</attribute>
                </xpath>
                <xpath expr="//field[@name='email_from']/parent::div" position="attributes">
                    <attribute name="invisible">1</attribute>
                </xpath>
                <xpath expr="//field[@name='email_from']" position="attributes">
                    <attribute name="invisible">1</attribute>
                </xpath>
                <xpath expr="//field[@name='partner_address_phone']" position="attributes">
                    <attribute name="invisible">1</attribute>
                </xpath>
                <xpath expr="//field[@name='tag_ids']" position="attributes">
                    <attribute name="invisible">1</attribute>
                </xpath>

                <xpath expr="//field[@name='name']" position="attributes">
                    <attribute name="style">width: 50% !important;</attribute>
                </xpath>
                <xpath expr="//group" position="after">
                    <group>
                        <group>
                            <field name="opp_type"/>
                        </group>
                        <group attrs="{'invisible': [('opp_type', '!=', 'insurance_app')]}">
                            <field name="state" invisible="1"/>
                            <field name="lob"/>
                            <field name="product_id"/>
                            <field name="name" />
                            <field name="phone" />
                            <field name="email" />
                        </group>

                        <group attrs="{'invisible': [('opp_type', '!=', 'insurance_app')]}">

                            <field name="application_number" readonly="1" force_save="1"/>
                            <field name="application_date" />
                            <field name="policy_number" readonly="1" force_save="1" attrs="{'invisible': [('policy_number', '=', False)]}"/>
                            <field name="policy_issue_date" readonly="1" force_save="1" attrs="{'invisible': [('policy_issue_date', '=', False)]}"/>


                        </group>
                    </group>
                </xpath>
                <xpath expr="//label[@for='planned_revenue']" position="attributes">
                    <attribute name="invisible">1</attribute>
                </xpath>
                <xpath expr="//label[@for='probability']" position="attributes">
                    <attribute name="invisible">1</attribute>
                </xpath>
                <xpath expr="//label[@for='email_from']" position="attributes">
                    <attribute name="invisible">1</attribute>
                </xpath>

                <xpath expr="//field[@name='description']/parent::page" position="attributes">
                    <attribute name="invisible">1</attribute>>
                </xpath>
                <xpath expr="//page[@name='lead']" position="attributes">
                    <attribute name="invisible">1</attribute>>
                </xpath>
                <notebook>
                    <page string="Required For Survey" attrs="{'invisible': ['|',('opp_type', '!=', 'insurance_app'),('state', '!=', 'survey')]}">
                        <group>
                            <group>
                                <field name="name_of_contact_person"/>
                            </group>
                            <group>
                                <field name="main_phone"/>
                            </group>
                            <group>
                                <field name="spare_phone"/>
                            </group>
                        </group>
                    </page>
                    <page string="Application Form And Required Documents" groups="Arope_spaces.managers_group,Arope_spaces.broker_space_group" attrs="{'invisible': [('opp_type', '!=', 'insurance_app')]}">
                        <field name="persons" >
                            <tree editable="bottom">
                                <field name="insured" readonly="1" force_save="1"/>
                                <field name="download_files" widget="many2many_binary"/>
                                <field name="application_file" widget="many2many_binary"/>
                                <button name="required_document" string="Required Documents" type="object" class="oe_highlight"/>
                                <field name="comment"/>
                                <field name="issue_in_progress_state"/>
                            </tree>
                        </field>

                    </page>
                    <page string="Offers" groups="Arope_spaces.managers_group,Arope_spaces.broker_space_group" attrs="{'invisible': [('opp_type', '!=', 'insurance_app')]}">
                        <field name="offer_ids" >
                            <tree editable="bottom" decoration-danger="offer_state == 'pending'">
                                <field name="type" />
                                <field name="date" />
                                <field name="file" widget="many2many_binary" />
                                <field name="offer_state"/>
                                <field name="comment"/>
                            </tree>
                        </field>
                    </page>
                </notebook>
            </field>
        </record>
        <record model="ir.actions.act_window" id="ibs_crm_lead_opportunities">
            <field name="name">Opportunities</field>
            <field name="res_model">crm.lead</field>
            <field name="view_mode">kanban,tree,graph,pivot,form,calendar</field>
            <field name="domain">[('type','=','opportunity')]</field>
            <field name="context">{
                'default_type': 'opportunity',
                'default_user_id': uid
                }
            </field>
        </record>
    </data>
</odoo>